---
import image1 from "../assets/image 1.png";
import image2 from "../assets/sample.jpg";
import image3 from "../assets/image 3.png";
import image4 from "../assets/image 4.png";
import image5 from "../assets/image 5.png";
import LogoBig from "./LogoBig.astro";
import LogoShort from "./LogoShort.astro";
import { BigUnderline, MdLogo } from "../utils/svgs.tsx";
import "../scss/top.scss";
import SlideComponent from "./SlideShow.tsx";

import { getForm, getSlide } from "../lib/microcms";
const response = await getForm({ fields: ["id", "url", "form_on"] });
const formData = response.contents[0];

// microCMSからスライド画像を取得
const slideResponse = await getSlide({ fields: ["id", "images"] });
const slideImages = slideResponse.contents[0]?.images || [];

// フォールバック用のローカル画像
const defaultSlides = [image1, image2, image3, image4, image5];
---

<section id="top" class="p-top flex w-full">
  <span class="fish">
    <LogoShort />
  </span>

  <span class="p-top__md__fish">
    <MdLogo />
  </span>

  <div class="p-top__left__content">
    <h1 class="zenkaku_normal tracking-widest p-top__left__content__headline">
      Let's enjoy fishing with us!
    </h1>
    {formData?.form_on && (
      <div class="p-top__left__content__join__link flex_all_center">
        <div class="p-top__left__content__join__link__content relative">
          <a class="p-top__left__content__join__link__content__link"
            href={formData.url}
          >
            Join us!
          </a>

          <div class="p-top__left__content__join__link__content__svg">
            <BigUnderline />
          </div>
        </div>
      </div>
    )}
  </div>
  <div class="p-top__right__content w-[60%]">
    <div class="p-top__right__content__img__wrapper relative">
      <span class="fish_big">
        <LogoBig />
      </span>
      <SlideComponent
        imgProps={defaultSlides}
        externalImages={slideImages}
        showIndicators={false}
        showProgressBar={true}
        client:only="preact"
      />
    </div>
  </div>
</section>
